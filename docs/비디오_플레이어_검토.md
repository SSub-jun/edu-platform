# 비디오 플레이어 솔루션 검토

## 📋 요구사항
1. **이어보기**: 진도율에 따라 이전 시청 위치부터 재생
2. **Seeking 제한**: 시청하지 않은 부분으로 이동 불가
3. **배속 제한**: 배속 재생 방지 (1.0x 고정)
4. **진도 추적**: 시청 시간 및 진도율 실시간 서버 전송
5. **클라우드 호환**: 로컬 및 클라우드 스토리지 모두 지원
6. **안정성**: 프로덕션 환경에서 안정적 동작

---

## 🎬 비디오 플레이어 옵션 비교

### 1. **HTML5 `<video>` (현재 사용 중) ✅**

#### 장점:
- ✅ **표준 기술**: 별도 라이브러리 불필요
- ✅ **가벼움**: 번들 크기 0KB
- ✅ **완전한 제어**: 모든 이벤트 및 속성 직접 제어 가능
- ✅ **호환성**: 모든 최신 브라우저 지원
- ✅ **커스터마이징**: 원하는 기능 직접 구현 가능

#### 단점:
- ❌ **직접 구현 필요**: Seeking 제한 등 고급 기능 직접 개발
- ❌ **크로스 브라우저 이슈**: 각 브라우저별 미묘한 차이 대응 필요
- ❌ **HLS/DASH 미지원**: 적응형 스트리밍 위해 추가 라이브러리 필요

#### 현재 구현 개선사항:
```typescript
// ✅ 이어보기: loadedmetadata 이벤트에서 currentTime 설정
video.currentTime = maxReachedSeconds;

// ✅ Seeking 제한: seeking/seeked/play 이벤트에서 강제 제한
if (currentTime > maxReachedSeconds) {
  video.currentTime = maxReachedSeconds;
}

// ✅ 배속 제한: ratechange 이벤트에서 1.0 강제
video.playbackRate = 1.0;
```

#### 평가: ⭐⭐⭐⭐☆ (4/5)
- 요구사항 모두 충족 가능
- 추가 라이브러리 없이 가벼움
- Seeking 제한 안정성 개선 필요

---

### 2. **Video.js** 🎥

#### 개요:
- 가장 인기 있는 오픈소스 비디오 플레이어 (48k⭐)
- HTML5 비디오 위에 풍부한 기능 제공
- HLS, DASH 등 적응형 스트리밍 지원

#### 장점:
- ✅ **풍부한 플러그인**: 100+ 플러그인 생태계
- ✅ **적응형 스트리밍**: HLS/DASH 기본 지원
- ✅ **크로스 브라우저**: 일관된 동작 보장
- ✅ **커스터마이즈 가능**: 테마, 컨트롤 등 자유롭게 수정
- ✅ **안정성**: 수년간 검증된 프로덕션 레벨

#### 단점:
- ❌ **번들 크기**: ~200KB (gzipped)
- ❌ **React 통합**: 공식 React 컴포넌트 없음 (커뮤니티 제공)
- ❌ **학습 곡선**: API 학습 필요

#### 구현 예시:
```typescript
import videojs from 'video.js';

useEffect(() => {
  const player = videojs(videoRef.current, {
    controls: true,
    autoplay: false,
    preload: 'auto',
  });

  // Seeking 제한 플러그인 추가
  player.on('seeking', () => {
    if (player.currentTime() > maxReached) {
      player.currentTime(maxReached);
    }
  });

  return () => player.dispose();
}, []);
```

#### 평가: ⭐⭐⭐⭐⭐ (5/5)
- 모든 요구사항 충족 가능
- 프로덕션 레벨 안정성
- 번들 크기 증가는 trade-off

---

### 3. **Plyr** 🎨

#### 개요:
- 심플하고 접근성 좋은 비디오 플레이어 (26k⭐)
- HTML5, YouTube, Vimeo 지원
- 모던한 UI/UX

#### 장점:
- ✅ **가벼움**: ~25KB (gzipped)
- ✅ **접근성**: WCAG 2.1 AA 준수
- ✅ **UI**: 기본 제공 UI가 깔끔하고 모던
- ✅ **React 컴포넌트**: plyr-react 제공

#### 단점:
- ❌ **제한적 API**: Video.js보다 기능 적음
- ❌ **HLS/DASH**: 기본 미지원 (hls.js 추가 필요)
- ❌ **플러그인**: 생태계가 작음

#### 구현 예시:
```typescript
import Plyr from 'plyr-react';

<Plyr
  source={{
    type: 'video',
    sources: [{ src: videoUrl, type: 'video/mp4' }],
  }}
  options={{
    controls: ['play', 'progress', 'current-time', 'mute', 'volume'],
    speed: { selected: 1, options: [1] }, // 배속 제한
  }}
/>
```

#### 평가: ⭐⭐⭐☆☆ (3/5)
- Seeking 제한 구현 복잡
- UI는 좋지만 기능 제한적

---

### 4. **React Player** ⚛️

#### 개요:
- React 친화적 비디오 플레이어 (9k⭐)
- YouTube, Vimeo, Twitch, 파일 등 다양한 소스 지원

#### 장점:
- ✅ **React 네이티브**: React에 최적화
- ✅ **다양한 소스**: 여러 플랫폼 통합
- ✅ **간단한 API**: 사용하기 쉬움

#### 단점:
- ❌ **제어 제한**: Seeking 제한 같은 고급 기능 구현 어려움
- ❌ **커스터마이즈**: 내부 컨트롤 수정 어려움
- ❌ **일관성**: 소스마다 동작 다름

#### 평가: ⭐⭐☆☆☆ (2/5)
- Seeking 제한 구현 불가능에 가까움
- 교육 플랫폼에 부적합

---

### 5. **HLS.js + Custom Controls** 🎛️

#### 개요:
- HLS 스트리밍 전용 라이브러리
- HTML5 video와 조합하여 사용

#### 장점:
- ✅ **적응형 스트리밍**: 네트워크 상황에 따라 화질 자동 조정
- ✅ **가벼움**: ~200KB
- ✅ **완전한 제어**: HTML5 video처럼 직접 제어

#### 단점:
- ❌ **HLS 전용**: MP4 등 다른 포맷은 별도 처리
- ❌ **컨트롤 직접 구현**: UI 컨트롤 직접 만들어야 함
- ❌ **복잡도**: 설정 및 에러 처리 복잡

#### 평가: ⭐⭐⭐☆☆ (3/5)
- 현재는 오버스펙
- 향후 HLS 스트리밍 도입 시 고려

---

## 🏆 최종 추천

### **Option A: 현재 HTML5 `<video>` 개선 (단기 추천) ✅**

**추천 이유:**
1. **가벼움**: 추가 라이브러리 불필요
2. **완전한 제어**: 모든 요구사항 직접 구현 가능
3. **성능**: 번들 크기 0KB
4. **학습 곡선**: 이미 구현 완료

**개선 필요 사항:**
- ✅ 이어보기 로직 개선 (완료)
- ✅ Seeking 제한 강화 (완료)
- ✅ 배속 제한 검증 (완료)
- 🔄 크로스 브라우저 테스트 필요 (Safari, Firefox 등)

**구현 우선순위:**
1. 현재 구현 테스트 및 버그 수정
2. 크로스 브라우저 호환성 확인
3. 에러 핸들링 강화

---

### **Option B: Video.js 마이그레이션 (장기 추천) 🎥**

**추천 이유:**
1. **안정성**: 검증된 프로덕션 레벨 라이브러리
2. **확장성**: 향후 HLS/DASH 스트리밍 쉽게 추가
3. **크로스 브라우저**: 일관된 동작 보장
4. **커뮤니티**: 활발한 개발 및 지원

**마이그레이션 시기:**
- 현재 구현으로 문제 해결 안 될 경우
- HLS 스트리밍 도입 시
- 더 풍부한 UI/UX 필요 시

**예상 작업량:**
- 1-2일 (Video.js 통합 + 기능 재구현)
- 번들 크기 +200KB

---

## 📝 결론

**현재 상황:**
- HTML5 `<video>` 기반 구현 완료
- Seeking 제한 및 이어보기 로직 개선 완료
- 테스트 후 안정성 확인 필요

**권장 방향:**
1. **현재 구현 테스트** (1일)
   - 다양한 시나리오 테스트
   - 크로스 브라우저 확인
   
2. **문제 없으면 유지**, 문제 발생 시:
   - Video.js 마이그레이션 검토
   
3. **향후 HLS 스트리밍 도입 시**:
   - Video.js + videojs-contrib-hls
   - 또는 HLS.js + Custom Controls

---

## 🧪 테스트 체크리스트

- [ ] 이어보기: 진도율 50%에서 재접속 시 해당 위치부터 재생
- [ ] Seeking 제한: 시청하지 않은 부분으로 이동 시 자동으로 되돌아감
- [ ] 배속 제한: 개발자 도구로 playbackRate 변경 시 1.0으로 강제
- [ ] 진도 추적: 5초마다 서버에 진도 전송
- [ ] 크로스 브라우저: Chrome, Safari, Firefox, Edge 모두 동작
- [ ] 모바일: iOS Safari, Android Chrome 동작 확인
- [ ] 네트워크 오류: 비디오 로드 실패 시 적절한 에러 메시지



